 cat *.txt | perl -pe 's/( (\d{8})T(\d{2})(\d{2})(\d{2}) )/${1}${2} ${3}:${4}:${5} /' | awk '$5 == "<player_color/init>" || $5 == "<player_color/set>" {color[$6]=$9} $5 == "<chat/msg>" {n=$6 " " $7; c=color[$6]; t=$4; text=$0; gsub(/'"'"'$/, "", text) gsub(/^.+ \([0-9]+\) '"'"'/, "", text); ptint $0; printf("%s <p><span class=\"t\">%s</span><span class=\"n\" style=\"color: #%s\">%s:</span>&nbsp;<span class=\"m\">%s</span></p>\n", $3, t, c, n, text)}' | grep '20100821' | perl -pe 's/^\d{8} //' > /cygdrive/d/1.txt
